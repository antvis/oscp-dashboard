/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/@antv/g-plugin-dragndrop@2.0.5/dist/index.esm.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{__extends as t,__assign as e,__awaiter as n,__generator as r}from"../../tslib@2.6.3/_esm.js";import{AbstractRendererPlugin as i}from"../g-lite@2.0.5/_esm.js";import{distanceSquareRoot as o}from"../util@3.3.7/_esm.js";var a=function(){function t(t){this.dragndropPluginOptions=t}return t.prototype.apply=function(e){var i=this,a=e.renderingService,s=e.renderingContext.root.ownerDocument,p=s.defaultView,d=function(t){var e=t.target,a=e===s,d=a&&i.dragndropPluginOptions.isDocumentDraggable?s:e.closest&&e.closest("[draggable=true]");if(d){var l=!1,c=t.timeStamp,u=[t.clientX,t.clientY],g=null,v=[t.clientX,t.clientY],h=function(t){return n(i,void 0,void 0,(function(){var n,i,p,h,m,f;return r(this,(function(r){switch(r.label){case 0:if(!l){if(n=t.timeStamp-c,i=o([t.clientX,t.clientY],u),n<=this.dragndropPluginOptions.dragstartTimeThreshold||i<=this.dragndropPluginOptions.dragstartDistanceThreshold)return[2];t.type="dragstart",d.dispatchEvent(t),l=!0}return t.type="drag",t.dx=t.clientX-v[0],t.dy=t.clientY-v[1],d.dispatchEvent(t),v=[t.clientX,t.clientY],a?[3,2]:(p="pointer"===this.dragndropPluginOptions.overlap?[t.canvasX,t.canvasY]:e.getBounds().center,[4,s.elementsFromPoint(p[0],p[1])]);case 1:h=r.sent(),m=h[h.indexOf(e)+1],f=(null==m?void 0:m.closest("[droppable=true]"))||(this.dragndropPluginOptions.isDocumentDroppable?s:null),g!==f&&(g&&(t.type="dragleave",t.target=g,g.dispatchEvent(t)),f&&(t.type="dragenter",t.target=f,f.dispatchEvent(t)),(g=f)&&(t.type="dragover",t.target=g,g.dispatchEvent(t))),r.label=2;case 2:return[2]}}))}))};p.addEventListener("pointermove",h);var m=function(t){if(l){t.detail={preventClick:!0};var e=t.clone();g&&(e.type="drop",e.target=g,g.dispatchEvent(e)),e.type="dragend",d.dispatchEvent(e),l=!1}p.removeEventListener("pointermove",h)};e.addEventListener("pointerup",m,{once:!0}),e.addEventListener("pointerupoutside",m,{once:!0})}};a.hooks.init.tap(t.tag,(function(){p.addEventListener("pointerdown",d)})),a.hooks.destroy.tap(t.tag,(function(){p.removeEventListener("pointerdown",d)}))},t.tag="Dragndrop",t}(),s=function(n){function r(t){void 0===t&&(t={});var e=n.call(this)||this;return e.options=t,e.name="dragndrop",e}return t(r,n),r.prototype.init=function(){this.addRenderingPlugin(new a(e({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))},r.prototype.destroy=function(){this.removeAllRenderingPlugins()},r.prototype.setOptions=function(t){Object.assign(this.plugins[0].dragndropPluginOptions,t)},r}(i);export{s as Plugin};export default null;
