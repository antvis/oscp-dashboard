/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/@antv/coord@0.4.7/esm/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{identity as r,deepMix as t}from"../util@2.0.17/_esm.js";import{mat3 as n,mat4 as o,vec3 as e,vec4 as a}from"../../gl-matrix@3.4.3/_esm.js";import{Linear as i,Point as u}from"../scale@0.4.16/_esm.js";function f(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return t?n.reduce((function(r,t){return function(n){return t(r(n))}}),t):r}function l(r){return r instanceof Float32Array||r instanceof Array}var c=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},s=function(r,t,n){if(n||2===arguments.length)for(var o,e=0,a=t.length;e<a;e++)!o&&e in t||(o||(o=Array.prototype.slice.call(t,0,e)),o[e]=t[e]);return r.concat(o||Array.prototype.slice.call(t))};function y(r,t,n){for(;r<t;)r+=2*Math.PI;for(;r>n;)r-=2*Math.PI;return r}var p=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},h=function(r,t,o,e,a){var i=p(r,2),u=i[0],f=i[1],l=n.create();return n.fromTranslation(l,[u,f])},v=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},m=function(r,t,n,o,e){var a=new i({range:[t,t+o]}),u=new i({range:[n,n+e]});return{transform:function(r){var t=v(r,2),n=t[0],o=t[1];return[a.map(n),u.map(o)]},untransform:function(r){var t=v(r,2),n=t[0],o=t[1];return[a.invert(n),u.invert(o)]}}},d=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},g=function(r,t,n,o,e){return(0,d(r,1)[0])(t,n,o,e)},w=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},b=function(r,t,n,o,e){return w(r,1)[0]},S=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},x=function(r,t,n,o,e){var a=S(r,4),u=a[0],f=a[1],l=a[2],c=a[3],s=new i({range:[l,c]}),p=new i({range:[u,f]}),h=e/o,v=h>1?1:h,m=h>1?1/h:1;return{transform:function(r){var t=S(r,2),n=t[0],o=t[1],e=p.map(n),a=s.map(o);return[.5*(a*Math.cos(e)*v)+.5,.5*(a*Math.sin(e)*m)+.5]},untransform:function(r){var t=S(r,2),n=t[0],o=t[1],e=2*(n-.5)/v,a=2*(o-.5)/m,i=Math.sqrt(Math.pow(e,2)+Math.pow(a,2)),l=y(Math.atan2(a,e),u,f);return[p.invert(l),s.invert(i)]}}},M=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},A=function(r,t,n,o,e){return{transform:function(r){var t=M(r,2),n=t[0];return[t[1],n]},untransform:function(r){var t=M(r,2),n=t[0];return[t[1],n]}}},T=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},z=function(r,t,o,e,a){var i=T(r,2),u=i[0],f=i[1],l=n.create();return n.fromScaling(l,[u,f])},I=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},P=function(r,t,n){if(n||2===arguments.length)for(var o,e=0,a=t.length;e<a;e++)!o&&e in t||(o||(o=Array.prototype.slice.call(t,0,e)),o[e]=t[e]);return r.concat(o||Array.prototype.slice.call(t))},q=function(r){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return z.apply(void 0,P([[-1,-1]],I(t),!1))},D=function(r){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return z.apply(void 0,P([[-1,1]],I(t),!1))},E=function(r){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return z.apply(void 0,P([[1,-1]],I(t),!1))},O=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},j=function(r,t,o,e,a){var i=O(r,1)[0],u=n.create();return n.fromRotation(u,i)},C=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},F=function(r,t,n,o,e){var a=C(r,4),u=a[0],f=a[1],l=a[2],c=(a[3]-l)/((f-0)/(2*Math.PI)+1),s=c/(2*Math.PI),p=new i({range:[l,l+.99*c]}),h=new i({range:[u,f]}),v=e/o,m=v>1?1:v,d=v>1?1/v:1;return{transform:function(r){var t=C(r,2),n=t[0],o=t[1],e=h.map(n),a=p.map(o);return[.5*(Math.cos(e)*(s*e+a)*m)+.5,.5*(Math.sin(e)*(s*e+a)*d)+.5]},untransform:function(r){var t=C(r,2),n=t[0],o=t[1],e=2*(n-.5)/m,a=2*(o-.5)/d,i=Math.sqrt(Math.pow(e,2)+Math.pow(a,2)),l=y(Math.atan2(a,e)+Math.floor(i/c)*Math.PI*2,u,f),v=i-s*l;return[h.invert(l),p.invert(v)]}}},R=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},k=function(r,t,n,o,e){var a=R(r,4),f=a[0],l=a[1],c=a[2],s=a[3],y=new i({range:[c,s]});return{transform:function(r){for(var t=[],n=r.length,o=new u({domain:new Array(n).fill(0).map((function(r,t){return t})),range:[f,l]}),e=0;e<n;e++){var a=r[e],i=o.map(e),c=y.map(a);t.push(i,c)}return t},untransform:function(r){for(var t=[],n=0;n<r.length;n+=2){var o=r[n+1];t.push(y.invert(o))}return t}}},B=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i};function G(r){return 1/Math.tan(r)}var H=function(r,t,n,o,e){var a=G(B(r,1)[0]);return{transform:function(r){var t=B(r,2),n=t[0],o=t[1];return[n+o*a,o]},untransform:function(r){var t=B(r,2),n=t[0],o=t[1];return[n-o*a,o]}}},J=function(r,t,n,o,e){var a=G(B(r,1)[0]);return{transform:function(r){var t=B(r,2),n=t[0];return[n,t[1]+n*a]},untransform:function(r){var t=B(r,2),n=t[0];return[n,t[1]-n*a]}}},K=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i};function L(r,t,n,o,e){var a=r<t,i=(a?t-o:e-t)||e-o,u=a?-1:1;return u*i*(n+1)/(n+i/((r-t)*u))+t}function N(r,t,n,o,e){var a=r<t,i=(a?t-o:e-t)||e-o;return i/(i*(n+1)/(r-t)-n*(a?-1:1))+t}function Q(r,t,n){return n?new i({range:[0,1],domain:[0,t]}).map(r):r}var U=function(r,t,n,o,e){var a=K(r,3),i=a[0],u=a[1],f=a[2],l=Q(i,o,void 0!==f&&f);return{transform:function(r){var t=K(r,2),n=t[0],o=t[1];return[L(n,l,u,0,1),o]},untransform:function(r){var t=K(r,2),n=t[0],o=t[1];return[N(n,l,u,0,1),o]}}},V=function(r,t,n,o,e){var a=K(r,3),i=a[0],u=a[1],f=a[2],l=Q(i,e,void 0!==f&&f);return{transform:function(r){var t=K(r,2);return[t[0],L(t[1],l,u,0,1)]},untransform:function(r){var t=K(r,2);return[t[0],N(t[1],l,u,0,1)]}}},W=function(r,t,n,o,e){var a=K(r,5),i=a[0],u=a[1],f=a[2],l=a[3],c=a[4],s=void 0!==c&&c,y=Q(i,o,s),p=Q(u,e,s);return{transform:function(r){var t=K(r,2),n=t[0],o=t[1];return[L(n,y,f,0,1),L(o,p,l,0,1)]},untransform:function(r){var t=K(r,2),n=t[0],o=t[1];return[N(n,y,f,0,1),N(o,p,l,0,1)]}}},X=function(r,t,n,o,e){var a=K(r,5),u=a[0],f=a[1],l=a[2],c=a[3],s=a[4],y=void 0!==s&&s,p=new i({range:[0,o]}),h=new i({range:[0,e]}),v=y?u:p.map(u),m=y?f:h.map(f);return{transform:function(r){var t=K(r,2),n=t[0],o=t[1],e=p.map(n)-v,a=h.map(o)-m,i=Math.sqrt(e*e+a*a);if(i>l)return[n,o];var u=L(i,0,c,0,l),f=Math.atan2(a,e),s=v+u*Math.cos(f),y=m+u*Math.sin(f);return[p.invert(s),h.invert(y)]},untransform:function(r){var t=K(r,2),n=t[0],o=t[1],e=p.map(n)-v,a=h.map(o)-m,i=Math.sqrt(e*e+a*a);if(i>l)return[n,o];var u=N(i,0,c,0,l),f=Math.atan2(a,e),s=v+u*Math.cos(f),y=m+u*Math.sin(f);return[p.invert(s),h.invert(y)]}}},Y=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},Z=function(r,t,n,o,e,a,u){var f=new i({range:[t,t+e]}),l=new i({range:[n,n+a]}),c=new i({range:[o,o+u]});return{transform:function(r){var t=Y(r,3),n=t[0],o=t[1],e=t[2];return[f.map(n),l.map(o),c.map(e)]},untransform:function(r){var t=Y(r,3),n=t[0],o=t[1],e=t[2];return[f.invert(n),l.invert(o),c.invert(e)]}}},$=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},_=function(r,t,n,e,a,i,u){var f=$(r,3),l=f[0],c=f[1],s=f[2];return o.fromTranslation(o.create(),[l,c,s])},rr=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},tr=function(r,t,n,o,e,a,i){return{transform:function(r){var t=rr(r,3),n=t[0];return[t[1],n,t[2]]},untransform:function(r){var t=rr(r,3),n=t[0];return[t[1],n,t[2]]}}},nr=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},or=function(r,t,n,e,a,i,u){var f=nr(r,3),l=f[0],c=f[1],s=f[2];return o.fromScaling(o.create(),[l,c,s])},er=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},ar=function(r,t,n){if(n||2===arguments.length)for(var o,e=0,a=t.length;e<a;e++)!o&&e in t||(o||(o=Array.prototype.slice.call(t,0,e)),o[e]=t[e]);return r.concat(o||Array.prototype.slice.call(t))},ir=function(r){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&r[t],o=0;if(n)return n.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&o>=r.length&&(r=void 0),{value:r&&r[o++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ur=function(){function o(r){this.options={x:0,y:0,width:300,height:150,transformations:[]},this.transformers={cartesian:m,translate:h,custom:g,matrix:b,polar:x,transpose:A,scale:z,"shear.x":H,"shear.y":J,reflect:q,"reflect.x":D,"reflect.y":E,rotate:j,helix:F,parallel:k,fisheye:W,"fisheye.x":U,"fisheye.y":V,"fisheye.circular":X},this.update(r)}return o.prototype.update=function(r){this.options=t({},this.options,r),this.recoordinate()},o.prototype.clone=function(){return new o(this.options)},o.prototype.getOptions=function(){return this.options},o.prototype.clear=function(){this.update({transformations:[]})},o.prototype.getSize=function(){var r=this.options;return[r.width,r.height]},o.prototype.getCenter=function(){var r=this.options,t=r.x,n=r.y;return[(2*t+r.width)/2,(2*n+r.height)/2]},o.prototype.transform=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var n=this.options.transformations;return this.update({transformations:ar(ar([],er(n),!1),[ar([],er(r),!1)],!1)}),this},o.prototype.map=function(r){return this.output(r)},o.prototype.invert=function(r){return this.input(r)},o.prototype.recoordinate=function(){this.output=this.compose(),this.input=this.compose(!0)},o.prototype.compose=function(t){var n,o;void 0===t&&(t=!1);var e=t?ar([],er(this.options.transformations),!1).reverse():this.options.transformations,a=t?function(r){return r.untransform}:function(r){return r.transform},i=[],u=[],y=function(r,t){return void 0===t&&(t=!0),u.push(t?function(r){return function(t){for(var n=[],o=0;o<t.length-1;o+=2){var e=[t[o],t[o+1]],a=r(e);n.push.apply(n,s([],c(a),!1))}return n}}(r):r)};try{for(var p=ir(e),h=p.next();!h.done;h=p.next()){var v=er(h.value),m=v[0],d=v.slice(1),g=this.transformers[m];if(g){var w=this.options,b=w.x,S=w.y,x=w.width,M=w.height,A=g(ar([],er(d),!1),b,S,x,M);if(l(A))i.push(A);else{if(i.length)y(this.createMatrixTransform(i,t)),i.splice(0,i.length);y(a(A)||r,"parallel"!==m)}}}}catch(r){n={error:r}}finally{try{h&&!h.done&&(o=p.return)&&o.call(p)}finally{if(n)throw n.error}}i.length&&y(this.createMatrixTransform(i,t));return f.apply(void 0,ar([],er(u),!1))},o.prototype.createMatrixTransform=function(r,t){var o=n.create();return t&&r.reverse(),r.forEach((function(r){return n.mul(o,o,r)})),t&&n.invert(o,n.clone(o)),function(r){var t=[r[0],r[1],1];return e.transformMat3(t,t,o),[t[0],t[1]]}},o}(),fr=function(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var o,e,a=n.call(r),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(r){e={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},lr=function(r,t,n){if(n||2===arguments.length)for(var o,e=0,a=t.length;e<a;e++)!o&&e in t||(o||(o=Array.prototype.slice.call(t,0,e)),o[e]=t[e]);return r.concat(o||Array.prototype.slice.call(t))},cr=function(r){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&r[t],o=0;if(n)return n.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&o>=r.length&&(r=void 0),{value:r&&r[o++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},sr=function(){function n(r){this.options={x:0,y:0,z:0,width:300,height:150,depth:150,transformations:[]},this.transformers={cartesian3D:Z,translate3D:_,scale3D:or,transpose3D:tr},this.update(r)}return n.prototype.update=function(r){this.options=t({},this.options,r),this.recoordinate()},n.prototype.clone=function(){return new n(this.options)},n.prototype.getOptions=function(){return this.options},n.prototype.clear=function(){this.update({transformations:[]})},n.prototype.getSize=function(){var r=this.options;return[r.width,r.height,r.depth]},n.prototype.getCenter=function(){var r=this.options,t=r.x,n=r.y,o=r.z;return[(2*t+r.width)/2,(2*n+r.height)/2,(2*o+r.depth)/2]},n.prototype.transform=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var n=this.options.transformations;return this.update({transformations:lr(lr([],fr(n),!1),[lr([],fr(r),!1)],!1)}),this},n.prototype.map=function(r){return this.output(r)},n.prototype.invert=function(r){return this.input(r)},n.prototype.recoordinate=function(){this.output=this.compose(),this.input=this.compose(!0)},n.prototype.compose=function(t){var n,o;void 0===t&&(t=!1);var e=t?lr([],fr(this.options.transformations),!1).reverse():this.options.transformations,a=t?function(r){return r.untransform}:function(r){return r.transform},i=[],u=[],y=function(r,t){return void 0===t&&(t=!0),u.push(t?function(r){return function(t){for(var n=[],o=0;o<t.length-1;o+=3){var e=[t[o],t[o+1],t[o+2]],a=r(e);n.push.apply(n,s([],c(a),!1))}return n}}(r):r)};try{for(var p=cr(e),h=p.next();!h.done;h=p.next()){var v=fr(h.value),m=v[0],d=v.slice(1),g=this.transformers[m];if(g){var w=this.options,b=w.x,S=w.y,x=w.z,M=w.width,A=w.height,T=w.depth,z=g(lr([],fr(d),!1),b,S,x,M,A,T);if(l(z))i.push(z);else{if(i.length)y(this.createMatrixTransform(i,t)),i.splice(0,i.length);y(a(z)||r,!0)}}}}catch(r){n={error:r}}finally{try{h&&!h.done&&(o=p.return)&&o.call(p)}finally{if(n)throw n.error}}i.length&&y(this.createMatrixTransform(i,t));return f.apply(void 0,lr([],fr(u),!1))},n.prototype.createMatrixTransform=function(r,t){var n=o.create();return t&&r.reverse(),r.forEach((function(r){return o.mul(n,n,r)})),t&&o.invert(n,o.clone(n)),function(r){var t=[r[0],r[1],r[2],1];return a.transformMat4(t,t,n),[t[0],t[1],t[2]]}},n}();export{ur as Coordinate,sr as Coordinate3D};export default null;
